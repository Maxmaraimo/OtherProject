jQuery(document).ready(function(a){"use strict";var e,n=function(a){return a.is(".processing")||a.parents(".processing").length},t=function(e){if(a("body").trigger("nasa_publish_coupon_refresh"),!n(e)){var t=a("body").hasClass("nasa-dark")?"#000":"#fff";e.addClass("processing").block({message:null,overlayCSS:{background:t,opacity:.6}})}},s=function(e){e.removeClass("processing").unblock(),e.find(".nasa-close-node").length&&e.find(".nasa-close-node").trigger("click"),a("body").trigger("nasa_publish_coupon_refresh"),a("#cart-sidebar select.country_to_state, #cart-sidebar input.country_to_state").length&&(a("#cart-sidebar select.country_to_state, #cart-sidebar input.country_to_state").trigger("change"),a(document.body).trigger("country_to_state_changed"))},o=function(a){return ext_mini_cart_params.wc_ajax_url.toString().replace("%%endpoint%%",a)},r=function(n){a(".ext-mini-cart-wrap .mess-wrap").remove(),a(".ext-mini-cart-wrap").append('<div class="mess-wrap">'+n+"</div>"),e&&clearTimeout(e),e=setTimeout(function(){a(".ext-mini-cart-wrap .mess-wrap").remove()},5e3)};a("body").on("nasa_opened_cart_sidebar",function(){a("body").hasClass("canvas-on")||a("body").addClass("canvas-on"),a("body").trigger("ns_render_ext_mini_cart_nonce"),a("body").trigger("nasa_publish_coupon_refresh")}),a("body").on("nasa_after_close_fog_window",function(){a("body").removeClass("canvas-on")}),a("body").on("click",".nasa-close-node",function(){var e=a(this).parents(".nasa-static-sidebar"),n=a(this).parents(".ext-node");a(this).parents(".ns-cart-popup-wrap").length&&(e=a(this).parents(".ns-cart-popup")),a(e).length&&a(e).removeClass("ext-loading"),a(n).length&&a(n).removeClass("active"),a(n).hasClass("mini-cart-change-variation")&&(nasa_quick_viewimg=!1,setTimeout(function(){a(n).find(".product-lightbox").remove()},100)),a(e).find(".close-nodes").remove()}),a("body").on("click",".nasa-static-sidebar .close-nodes, .ns-cart-popup .close-nodes",function(){var e=a(this).parents(".ns-cart-popup-wrap").length?a(this).parents(".ns-cart-popup"):a(this).parents(".nasa-static-sidebar"),n=a(e).find(".ext-nodes-wrap .ext-node.active .nasa-close-node");a(n).length&&a(n).trigger("click")}),a("body").on("click",".ext-mini-cart",function(){var e=a(this).attr("data-act"),n=a(this).parents(".nasa-static-sidebar");a(this).parents(".ns-cart-popup-wrap").length&&(n=a(this).parents(".ns-cart-popup")),a(n).find(".ext-mini-cart-wrap").length&&!a(n).find(".ext-mini-cart-wrap").hasClass("nasa-disable")&&(a("body").hasClass("canvas-on")||a("body").addClass("canvas-on"),a(n).hasClass("ext-loading")||a(n).addClass("ext-loading"),a(n).find(".close-nodes").length<1&&a(n).append('<a href="javascript:void(0);" class="close-nodes"></a>'),a(n).find(".ext-nodes-wrap .ext-node").removeClass("active"),a(n).find(".ext-nodes-wrap .ext-node.mini-cart-"+e).length&&a(n).find(".ext-nodes-wrap .ext-node.mini-cart-"+e).addClass("active"))}),a("body").on("click","#mini-cart-save_note",function(e){e.preventDefault();var n=a(this),i=a(n).parents(".ext-node");if(!a(n).hasClass("nasa-disable")){a(n).addClass("nasa-disable");var c=a(n).parents(".nasa-static-sidebar");a(c).length<1&&(c=a(n).parents(".widget_shopping_cart_content"));var d=a('.mini-cart-note textarea[name="order_comments"]').val();t(c),a(i).removeClass("active"),a.ajax({url:o("nasa_mini_cart_note"),type:"post",dataType:"json",cache:!1,data:{order_comments:d},success:function(e){a("#cart-sidebar").find(".woocommerce-error, .woocommerce-message, .woocommerce-info").remove(),a(n).removeClass("nasa-disable"),e&&(e.fragments&&(a.each(e.fragments,function(e,n){a(e).length&&a(e).replaceWith(n)}),a("body").trigger("wc_fragments_refreshed"),a("body").trigger("nasa_init_shipping_free_notification")),e.mess&&r(e.mess)),a("body").trigger("mini_cart_mobile_layout_change"),s(c)},complete:function(){s(c)}})}}),a("body").on("wc_fragments_refreshed",function(){a("#cart-sidebar select.country_to_state, #cart-sidebar input.country_to_state").length&&(a("#cart-sidebar select.country_to_state, #cart-sidebar input.country_to_state").trigger("change"),a(document.body).trigger("country_to_state_changed"))}),a("body").on("nasa_publish_coupon_refresh",function(){a(".mini-cart-coupon .publish-coupon").length&&a(".mini-cart-coupon .publish-coupon").each(function(){var e=a(this),n=a(e).attr("data-code");a(e).removeClass("nasa-actived"),a('.coupon-wrap[data-code="'+n+'"]').length&&a(e).addClass("nasa-actived")})}),a("body").on("click",".mini-cart-coupon .publish-coupon:not(.nasa-actived)",function(){var e=this,n=a(e).attr("data-code");a("#mini-cart-add-coupon_code").length&&(a("#mini-cart-add-coupon_code").val(n).trigger("change"),a("#mini-cart-apply_coupon").length&&a("#mini-cart-apply_coupon").trigger("click"))}),a("body").on("click","#mini-cart-apply_coupon",function(e){e.preventDefault();var n=a(this),i=a(n).parents(".ext-node"),c=a(".mini-cart-ajax-nonce input[name=apply_coupon_nonce]").length?a(".mini-cart-ajax-nonce input[name=apply_coupon_nonce]").val():null;if(c&&!a(n).hasClass("nasa-disable")){a(n).addClass("nasa-disable");var d=a(n).parents(".nasa-static-sidebar");a(d).length<1&&(d=a(n).parents(".widget_shopping_cart_content"));var p=a("input#mini-cart-add-coupon_code").val();if(p){t(d),a(i).removeClass("active");var l={security:c,coupon_code:p};a.ajax({type:"POST",url:o("nasa_mini_cart_apply_coupon"),data:l,dataType:"json",success:function(e){a("#cart-sidebar").find(".woocommerce-error, .woocommerce-message, .woocommerce-info").remove(),a(n).removeClass("nasa-disable"),e&&(e.fragments&&(a.each(e.fragments,function(e,n){a(e).length&&a(e).replaceWith(n)}),a("body").trigger("wc_fragments_refreshed"),a("body").trigger("nasa_init_shipping_free_notification")),e.mess&&r(e.mess),a("input#mini-cart-add-coupon_code").val("").trigger("change")),a("body").trigger("mini_cart_mobile_layout_change"),s(d)},complete:function(){s(d)}})}else a(n).removeClass("nasa-disable")}}),a("body").on("click",".widget_shopping_cart_content .woocommerce-remove-coupon",function(e){e.preventDefault();var n=a(this),i=a(".mini-cart-ajax-nonce input[name=remove_coupon_nonce]").length?a(".mini-cart-ajax-nonce input[name=remove_coupon_nonce]").val():null;if(i&&!a(n).hasClass("nasa-disable")){a(n).addClass("nasa-disable");var c=a(n).parents(".nasa-static-sidebar");a(c).length<1&&(c=a(n).parents(".widget_shopping_cart_content")),t(c);var d=a(n).attr("data-coupon"),p={security:i,coupon:d};a.ajax({type:"POST",url:o("nasa_mini_cart_remove_coupon"),data:p,dataType:"json",success:function(e){a("#cart-sidebar").find(".woocommerce-error, .woocommerce-message, .woocommerce-info").remove(),a(n).removeClass("nasa-disable"),e&&(e.fragments&&(a.each(e.fragments,function(e,n){a(e).length&&a(e).replaceWith(n)}),a("body").trigger("wc_fragments_refreshed"),a("body").trigger("nasa_init_shipping_free_notification")),e.mess&&r(e.mess)),s(c)},complete:function(){s(c)}})}}),a("body").on("click",'.mini-cart-shipping [name="calc_shipping"]',function(e){e.preventDefault();var n=a(this),i=a(n).parents(".ext-node");if(!a(n).hasClass("nasa-disable")){a(n).addClass("nasa-disable");var c=a(n).parents(".nasa-static-sidebar"),d=a(n).parents("form");t(c),a(i).removeClass("active"),a("<input />").attr("type","hidden").attr("name","calc_shipping").attr("value","x").appendTo(d);var p=d.serialize();a.ajax({type:"POST",url:o("nasa_mini_cart_calculate_shipping"),data:p,dataType:"json",success:function(e){a("#cart-sidebar").find(".woocommerce-error, .woocommerce-message, .woocommerce-info").remove(),a(n).removeClass("nasa-disable"),e&&(e.fragments&&(a.each(e.fragments,function(e,n){a(e).length&&a(e).replaceWith(n)}),a("body").trigger("wc_fragments_refreshed"),a("body").trigger("nasa_init_shipping_free_notification")),e.mess&&r(e.mess)),a("body").trigger("mini_cart_mobile_layout_change"),s(c)},complete:function(){s(c)}})}});var i=Date.now();a("body").on("ns_render_ext_mini_cart_nonce",function(){a("#cart-sidebar select.country_to_state, #cart-sidebar input.country_to_state").length&&(a("#cart-sidebar select.country_to_state, #cart-sidebar input.country_to_state").trigger("change"),a(document.body).trigger("country_to_state_changed"));var e=Date.now();a("#cart-sidebar .mini-cart-ajax-nonce").length<=0&&10>(e-i)/1e3/60&&a.ajax({url:o("nasa_ext_cart_ajax_nonce"),type:"post",dataType:"json",cache:!1,data:{},success:function(e){e&&(e.fds&&a("#cart-sidebar").append(e.fds),e.scalc&&a("input#woocommerce-shipping-calculator-nonce").length&&a("input#woocommerce-shipping-calculator-nonce").val(e.scalc))},complete:function(){}})})});