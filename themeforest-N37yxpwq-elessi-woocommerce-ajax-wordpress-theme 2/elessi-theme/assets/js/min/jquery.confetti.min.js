jQuery(document).ready(function(t){"use strict";t.confetti=new function(){function n(t){this.x=Math.random()*g,this.y=Math.random()*M-M,this.r=r(5,15),this.d=Math.random()*x+10,this.color=t,this.tilt=Math.floor(10*Math.random())-10,this.tiltAngleIncremental=.07*Math.random()+.05,this.tiltAngle=0,this.draw=function(){return y.beginPath(),y.lineWidth=this.r/2,y.strokeStyle=this.color,y.moveTo(this.x+this.tilt+this.r/4,this.y),y.lineTo(this.x+this.tilt,this.y+this.tilt+this.r/4),y.stroke()}}function o(){i(),t(window).on("resize",function(){g=window.innerWidth,M=window.innerHeight,w.width=g,w.height=M})}function i(){t("#nasa-confetti").length<1&&(t("form.nasa-shopping-cart-form").length?t("body").append('<canvas id="nasa-confetti" title="Turn off the freeship cannon" style="display: none;"></canvas>'):t("#cart-sidebar").length?t("#cart-sidebar").append('<canvas id="nasa-confetti" title="Turn off the freeship cannon" style="display: none;"></canvas>'):t("body").append('<canvas id="nasa-confetti" style="display: none;"></canvas>'),t("#ns-cart-popup").length&&t("#ns-cart-popup").parents(".ns-cart-popup-wrap").prepend('<canvas id="nasa-confetti-popup" title="Turn off the freeship cannon" style="display: none; position: relative; z-index: 9;"></canvas>')),w=document.getElementById("nasa-confetti"),t("#ns-cart-popup").parents(".ns-cart-popup-wrap").hasClass("nasa-active")&&(w=document.getElementById("nasa-confetti-popup")),y=w.getContext("2d"),g=window.innerWidth,M=window.innerHeight,w.width=g,w.height=M,q=!0}function e(){w.style.display="block",I=[],F=!1;for(var t=0;x>t;t++){var o=C.getColor();I.push(new n(o))}l()}function a(){x=t("body").hasClass("nasa-in-mobile")?50:300,y.clearRect(0,0,g,M);for(var n=[],o=0;x>o;o++)!function(t){n.push(I[t].draw())}(o);return s(),n}function r(t,n){return Math.floor(Math.random()*(n-t+1)+t)}function s(){var t,n=0;A+=.01,T+=.1;for(var o=0;x>o;o++){if(t=I[o],F)return;!_&&t.y<-15?t.y=M+100:(h(t,o),t.y<=M&&n++,c(t,o))}0===n&&p()}function c(t,n){(t.x>g+20||t.x<-20||t.y>M)&&_&&(n%5>0||n%2==0?d(t,Math.random()*g,-10,Math.floor(10*Math.random())-10):Math.sin(A)>0?d(t,-5,Math.random()*M,Math.floor(10*Math.random())-10):d(t,g+5,Math.random()*M,Math.floor(10*Math.random())-10))}function h(t,n){t.tiltAngle+=t.tiltAngleIncremental,t.y+=(Math.cos(A+t.d)+10+t.r/2)/2,t.x+=Math.sin(A),t.tilt=10*Math.sin(t.tiltAngle-n/3)}function d(t,n,o,i){t.x=n,t.y=o,t.tilt=i}function l(){q||o(),g=window.innerWidth,M=window.innerHeight,w.width=g,w.height=M,function t(){return F?null:(b=requestAnimFrame(t),a())}()}function f(){clearTimeout(v),clearTimeout(b)}function u(){_=!1,f()}function p(){q||o(),F=!0,"undefined"!=typeof y&&(y.clearRect(0,0,g,M),w.style.display="none")}function m(){q||o(),f(),p(),v=setTimeout(function(){_=!0,F=!1,e()},100)}var w,y,g,M,v,b,x=300,I=[],A=0,T=0,_=!0,F=!0,q=!1,C={colorOptions:["#EF2964","#00C09D","#2D87B0","#48485E","#EFFF1D"],colorIndex:0,colorIncrementer:0,colorThreshold:10,getColor:function(){return this.colorIncrementer>=10&&(this.colorIncrementer=0,this.colorIndex++,this.colorIndex>=this.colorOptions.length&&(this.colorIndex=0)),this.colorIncrementer++,this.colorOptions[this.colorIndex]}};window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return window.setTimeout(t,1e3/60)}}(),this.init=o,this.start=e,this.stop=u,this.restart=m},t("body").on("nasa_confetti_init",function(){t.confetti.init()}),t("body").on("nasa_confetti_start",function(n,o){t.confetti.start(),"undefined"!=typeof o&&setTimeout(function(){t("body").trigger("nasa_confetti_stop")},o)}),t("body").on("nasa_confetti_restart",function(n,o){t.confetti.restart(),"undefined"!=typeof o&&setTimeout(function(){t("body").trigger("nasa_confetti_stop")},o)}),t("body").on("nasa_confetti_stop",function(){t.confetti.stop()})});